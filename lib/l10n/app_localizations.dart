import 'package:flutter/material.dart';
import 'package:flutter_localizations/flutter_localizations.dart';
import 'package:intl/date_symbol_data_local.dart';

// Supporto per le lingue
class AppLocalizations {
  final Locale locale;

  AppLocalizations(this.locale);

  static AppLocalizations of(BuildContext context) {
    final localizations = Localizations.of<AppLocalizations>(
      context,
      AppLocalizations,
    );
    if (localizations == null) {
      // Fallback to default Italian locale
      return AppLocalizations(const Locale('it', 'IT'));
    }
    return localizations;
  }

  static const _localizedValues = {
    'it': {
      'app_title': 'JetCV Enterprise',
      'welcome': 'Benvenuto',
      'login': 'Accedi',
      'signup': 'Registrati',
      'email': 'Email',
      'password': 'Password',
      'confirm_password': 'Conferma Password',
      'first_name': 'Nome',
      'last_name': 'Cognome',
      'phone': 'Telefono',
      'address': 'Indirizzo',
      'city': 'Città',
      'country': 'Paese',
      'submit': 'Invia',
      'cancel': 'Annulla',
      'save': 'Salva',
      'edit': 'Modifica',
      'delete': 'Elimina',
      'view': 'Visualizza',
      'loading': 'Caricamento...',
      'error': 'Errore',
      'success': 'Successo',
      'warning': 'Attenzione',
      'info': 'Informazioni',
      'dashboard': 'Dashboard',
      'certifications': 'Certificazioni',
      'certifier_dashboard': 'Dashboard Certificatori',
      'issued_certifications': 'Certificazioni Emesse',
      'drafts_in_progress': 'Bozze e In Corso',
      'new_certification': 'Nuova Certificazione',
      'general_info': 'Info Generali',
      'users': 'Utenti',
      'results': 'Risultati',
      'review': 'Revisione',
      'general_information': 'Informazioni Generali',
      'enter_main_details':
          'Inserisci i dettagli principali della certificazione',
      'certification_title': 'Titolo Certificazione',
      'issuing_organization': 'Organizzazione Emittente',
      'my_legal_entity': 'La mia Legal Entity',
      'activity_type': 'Tipo Attività',
      'specific_course': 'Corso Specifico',
      'workshop': 'Workshop',
      'seminar': 'Seminario',
      'online_training': 'Formazione Online',
      'exam': 'Esame',
      'other': 'Altro',
      'description': 'Descrizione',
      'media_photos_videos': 'Media (Foto e Video)',
      'add_photos_videos': 'Aggiungi foto e video',
      'add': 'Aggiungi',
      'continue': 'Continua',
      'add_users': 'Aggiungi Utenti',
      'enter_participants': 'Inserisci i partecipanti alla certificazione',
      'enter_user_otp': 'Inserisci codice OTP utente',
      'enter_otp_code': 'Inserisci codice OT...',
      'scan_qr_code': 'Scansiona codice QR',
      'scan_qr_from_app': 'Scansiona il QR code dall\'app utente',
      'scan': 'Scansiona',
      'or': 'oppure',
      'added_users': 'Utenti Aggiunti',
      'remove_all': 'Rimuovi Tutti',
      'user_results': 'Risultati Utenti',
      'enter_results_for_each': 'Inserisci i risultati per ogni utente',
      'fill_fields_for_participants':
          'Compila i campi per ogni partecipante alla certificazione',
      'result': 'Risultato',
      'passed': 'Superato',
      'score': 'Punteggio',
      'evaluation': 'Valutazione',
      'media_photos_videos_short': 'Media (Foto e Video)',
      'certification_review': 'Revisione Certificazione',
      'check_details_before_sending':
          'Controlla tutti i dettagli prima di inviare la certificazione',
      'review_and_send': 'Revisione e Invio',
      'general_info_lower': 'Informazioni Generali',
      'real_time_media': 'Media Real-time',
      'no_general_media': 'Nessun media generale allegato',
      'users_count': 'Utenti',
      'certifier_media': 'Media del Certificatore',
      'confirm_send': 'Conferma Invio',
      'once_sent_warning':
          'Una volta inviata, la certificazione verrà inviata agli utenti destinatari e non sarà più modificabile. Una volta che gli utenti accetteranno la certificazione, questa verrà notarizzata sulla blockchain. Questa azione non può essere annullata.',
      'confirm_verification':
          'Confermo di aver verificato tutti i dettagli e di voler procedere con l\'invio della certificazione',
      'send_certification': 'Invia Certificazione',
      'back': 'Indietro',
      'continue_to_review': 'Continua alla Revisione',
      'certification_sent': 'Certificazione Inviata!',
      'certification_sent_success':
          'La certificazione "Corso Platform Management in-place" è stata inviato con successo.',
      'recipients_notification':
          'I destinatari riceveranno una notifica e potranno visualizzare la certificazione nei loro profili.',
      'completed': 'Completata',
      'certified': 'Certificati',
      'no_drafts_available': 'Nessuna bozza disponibile',
      'drafts_will_appear_here':
          'Le tue bozze e certificazioni in corso appariranno qui',
      'profile': 'Profilo',
      'settings': 'Impostazioni',
      'logout': 'Esci',
      'language': 'Lingua',
      'theme': 'Tema',
      'dark_mode': 'Modalità Scura',
      'light_mode': 'Modalità Chiara',
      'system': 'Sistema',
      'about': 'Informazioni',
      'version': 'Versione',
      'privacy_policy': 'Privacy Policy',
      'terms_of_service': 'Termini di Servizio',
      'contact_support': 'Contatta Supporto',
      'help': 'Aiuto',
      'search': 'Cerca',
      'filter': 'Filtra',
      'sort': 'Ordina',
      'refresh': 'Aggiorna',
      'sync': 'Sincronizza',
      'offline': 'Offline',
      'online': 'Online',
      'pending': 'In Attesa',
      'approved': 'Approvato',
      'rejected': 'Rifiutato',
      'draft': 'Bozza',
      'submitted': 'Inviata',
      'synchronized': 'Sincronizzata',
      'waiting_sync': 'In Attesa di Sincronizzazione',
      'certification_type': 'Tipo Certificazione',
      'certification_code': 'Codice',
      'certification_detail': 'Dettaglio',
      'certification_media': 'Media',
      'certification_location': 'Luogo',
      'certification_timestamp': 'Timestamp',
      'certification_description': 'Descrizione',
      'certification_attachments': 'Allegati',
      'certification_users': 'Utenti',
      'certification_result': 'Esito',
      'add_user': 'Aggiungi Utente',
      'user_info': 'Informazioni Utente',
      'qr_scan': 'Scansione QR',
      'otp_verification': 'Verifica OTP',
      'camera': 'Fotocamera',
      'gallery': 'Galleria',
      'file_attachment': 'Allegato File',
      'live_video': 'Video Live',
      'geolocation': 'Geolocalizzazione',
      'activity_type_not_found':
          'Il mio tipo attività non è incluso in questo elenco? Contatta JetCV Enterprise a questo indirizzo: test@mail.com',
      'kyc_verification': 'Verifica KYC',
      'kyc_pending': 'KYC in Attesa',
      'kyc_completed': 'KYC Completato',
      'kyc_failed': 'KYC Fallito',
      'certifier': 'Certificatore',
      'real_time': 'Tempo Reale',
      'offline_mode': 'Modalità Offline',
      'trusted_timestamp': 'Timestamp Fidato',
      'system_timestamp': 'Timestamp Sistema',
      'manual_timestamp': 'Timestamp Manuale',
      'sync_status': 'Stato Sincronizzazione',
      'sync_pending': 'In Attesa di Sincronizzazione',
      'sync_completed': 'Sincronizzazione Completata',
      'sync_failed': 'Sincronizzazione Fallita',
      'web_frame': 'Web Frame',
      'verify_call_api': 'Verifica Chiamata API',
      'check_veriff_session': 'Controlla Sessione Veriff',
      'demo_official_mastersheet': 'Demo Official Mastersheet R1.24',
      'certification_types': {
        'type_1': 'Tipo 1',
        'type_2': 'Tipo 2',
        'type_3': 'Tipo 3',
        'type_4': 'Tipo 4',
        'type_5': 'Tipo 5',
        'type_6': 'Tipo 6',
        'type_7': 'Tipo 7',
        'type_8': 'Tipo 8',
        'type_9': 'Tipo 9',
        'type_10': 'Tipo 10',
        'type_11': 'Tipo 11',
        'type_12': 'Tipo 12',
        'type_13': 'Tipo 13',
        'type_14': 'Tipo 14',
        'type_15': 'Tipo 15',
      },
    },
    'en': {
      'app_title': 'JetCV Enterprise',
      'welcome': 'Welcome',
      'login': 'Login',
      'signup': 'Sign Up',
      'email': 'Email',
      'password': 'Password',
      'confirm_password': 'Confirm Password',
      'first_name': 'First Name',
      'last_name': 'Last Name',
      'phone': 'Phone',
      'address': 'Address',
      'city': 'City',
      'country': 'Country',
      'submit': 'Submit',
      'cancel': 'Cancel',
      'save': 'Save',
      'edit': 'Edit',
      'delete': 'Delete',
      'view': 'View',
      'loading': 'Loading...',
      'error': 'Error',
      'success': 'Success',
      'warning': 'Warning',
      'info': 'Information',
      'dashboard': 'Dashboard',
      'certifications': 'Certifications',
      'profile': 'Profile',
      'settings': 'Settings',
      'logout': 'Logout',
      'language': 'Language',
      'theme': 'Theme',
      'dark_mode': 'Dark Mode',
      'light_mode': 'Light Mode',
      'system': 'System',
      'about': 'About',
      'version': 'Version',
      'privacy_policy': 'Privacy Policy',
      'terms_of_service': 'Terms of Service',
      'contact_support': 'Contact Support',
      'help': 'Help',
      'search': 'Search',
      'filter': 'Filter',
      'sort': 'Sort',
      'refresh': 'Refresh',
      'sync': 'Sync',
      'offline': 'Offline',
      'online': 'Online',
      'pending': 'Pending',
      'approved': 'Approved',
      'rejected': 'Rejected',
      'draft': 'Draft',
      'submitted': 'Submitted',
      'synchronized': 'Synchronized',
      'waiting_sync': 'Waiting for Synchronization',
      'certification_type': 'Certification Type',
      'certification_title': 'Title',
      'certification_code': 'Code',
      'certification_detail': 'Detail',
      'certification_media': 'Media',
      'certification_location': 'Luogo',
      'certification_timestamp': 'Timestamp',
      'certification_description': 'Description',
      'certification_attachments': 'Attachments',
      'certification_users': 'Users',
      'certification_result': 'Result',
      'add_user': 'Add User',
      'user_info': 'User Information',
      'qr_scan': 'QR Scan',
      'otp_verification': 'OTP Verification',
      'camera': 'Camera',
      'gallery': 'Gallery',
      'file_attachment': 'File Attachment',
      'live_video': 'Live Video',
      'geolocation': 'Geolocation',
      'activity_type_not_found':
          'My activity type is not included in this list? Contact JetCV Enterprise at this address: test@mail.com',
      'kyc_verification': 'KYC Verification',
      'kyc_pending': 'KYC Pending',
      'kyc_completed': 'KYC Completed',
      'kyc_failed': 'KYC Failed',
      'certifier': 'Certifier',
      'real_time': 'Real Time',
      'offline_mode': 'Offline Mode',
      'trusted_timestamp': 'Trusted Timestamp',
      'system_timestamp': 'System Timestamp',
      'manual_timestamp': 'Manual Timestamp',
      'sync_status': 'Sync Status',
      'sync_pending': 'Waiting for Synchronization',
      'sync_completed': 'Synchronization Completed',
      'sync_failed': 'Synchronization Failed',
      'web_frame': 'Web Frame',
      'verify_call_api': 'Verify Call API',
      'check_veriff_session': 'Check Veriff Session',
      'demo_official_mastersheet': 'Demo Official Mastersheet R1.24',
      'certification_types': {
        'type_1': 'Type 1',
        'type_2': 'Type 2',
        'type_3': 'Type 3',
        'type_4': 'Type 4',
        'type_5': 'Type 5',
        'type_6': 'Type 6',
        'type_7': 'Type 7',
        'type_8': 'Type 8',
        'type_9': 'Type 9',
        'type_10': 'Type 10',
        'type_11': 'Type 11',
        'type_12': 'Type 12',
        'type_13': 'Type 13',
        'type_14': 'Type 14',
        'type_15': 'Type 15',
      },
    },
    'de': {
      'app_title': 'JetCV Enterprise',
      'welcome': 'Willkommen',
      'login': 'Anmelden',
      'signup': 'Registrieren',
      'email': 'E-Mail',
      'password': 'Passwort',
      'confirm_password': 'Passwort bestätigen',
      'first_name': 'Vorname',
      'last_name': 'Nachname',
      'phone': 'Telefon',
      'address': 'Adresse',
      'city': 'Stadt',
      'country': 'Land',
      'submit': 'Absenden',
      'cancel': 'Abbrechen',
      'save': 'Speichern',
      'edit': 'Bearbeiten',
      'delete': 'Löschen',
      'view': 'Anzeigen',
      'loading': 'Laden...',
      'error': 'Fehler',
      'success': 'Erfolg',
      'warning': 'Warnung',
      'info': 'Information',
      'dashboard': 'Dashboard',
      'certifications': 'Zertifizierungen',
      'profile': 'Profil',
      'settings': 'Einstellungen',
      'logout': 'Abmelden',
      'language': 'Sprache',
      'theme': 'Thema',
      'dark_mode': 'Dunkler Modus',
      'light_mode': 'Heller Modus',
      'system': 'System',
      'about': 'Über',
      'version': 'Version',
      'privacy_policy': 'Datenschutzrichtlinie',
      'terms_of_service': 'Nutzungsbedingungen',
      'contact_support': 'Support kontaktieren',
      'help': 'Hilfe',
      'search': 'Suchen',
      'filter': 'Filter',
      'sort': 'Sortieren',
      'refresh': 'Aktualisieren',
      'sync': 'Synchronisieren',
      'offline': 'Offline',
      'online': 'Online',
      'pending': 'Ausstehend',
      'approved': 'Genehmigt',
      'rejected': 'Abgelehnt',
      'draft': 'Entwurf',
      'submitted': 'Eingereicht',
      'synchronized': 'Synchronisiert',
      'waiting_sync': 'Warten auf Synchronisierung',
      'certification_type': 'Zertifizierungstyp',
      'certification_title': 'Titel',
      'certification_code': 'Code',
      'certification_detail': 'Detail',
      'certification_media': 'Medien',
      'certification_location': 'Standort',
      'certification_timestamp': 'Zeitstempel',
      'certification_description': 'Beschreibung',
      'certification_attachments': 'Anhänge',
      'certification_users': 'Benutzer',
      'certification_result': 'Ergebnis',
      'add_user': 'Benutzer hinzufügen',
      'user_info': 'Benutzerinformationen',
      'qr_scan': 'QR-Scan',
      'otp_verification': 'OTP-Verifizierung',
      'camera': 'Kamera',
      'gallery': 'Galerie',
      'file_attachment': 'Dateianhang',
      'live_video': 'Live-Video',
      'geolocation': 'Geolokalisierung',
      'activity_type_not_found':
          'Mein Aktivitätstyp ist nicht in dieser Liste enthalten? Kontaktieren Sie JetCV Enterprise unter dieser Adresse: test@mail.com',
      'kyc_verification': 'KYC-Verifizierung',
      'kyc_pending': 'KYC ausstehend',
      'kyc_completed': 'KYC abgeschlossen',
      'kyc_failed': 'KYC fehlgeschlagen',
      'certifier': 'Zertifizierer',
      'real_time': 'Echtzeit',
      'offline_mode': 'Offline-Modus',
      'trusted_timestamp': 'Vertrauenswürdiger Zeitstempel',
      'system_timestamp': 'System-Zeitstempel',
      'manual_timestamp': 'Manueller Zeitstempel',
      'sync_status': 'Sync-Status',
      'sync_pending': 'Warten auf Synchronisierung',
      'sync_completed': 'Synchronisierung abgeschlossen',
      'sync_failed': 'Synchronisierung fehlgeschlagen',
      'web_frame': 'Web-Frame',
      'verify_call_api': 'Anruf-API verifizieren',
      'check_veriff_session': 'Veriff-Sitzung prüfen',
      'demo_official_mastersheet': 'Demo Offizielles Mastersheet R1.24',
      'certification_types': {
        'type_1': 'Typ 1',
        'type_2': 'Typ 2',
        'type_3': 'Typ 3',
        'type_4': 'Typ 4',
        'type_5': 'Typ 5',
        'type_6': 'Typ 6',
        'type_7': 'Typ 7',
        'type_8': 'Typ 8',
        'type_9': 'Typ 9',
        'type_10': 'Typ 10',
        'type_11': 'Typ 11',
        'type_12': 'Typ 12',
        'type_13': 'Typ 13',
        'type_14': 'Typ 14',
        'type_15': 'Typ 15',
      },
    },
    'fr': {
      'app_title': 'JetCV Enterprise',
      'welcome': 'Bienvenue',
      'login': 'Connexion',
      'signup': 'Inscription',
      'email': 'E-mail',
      'password': 'Mot de passe',
      'confirm_password': 'Confirmer le mot de passe',
      'first_name': 'Prénom',
      'last_name': 'Nom de famille',
      'phone': 'Téléphone',
      'address': 'Adresse',
      'city': 'Ville',
      'country': 'Pays',
      'submit': 'Soumettre',
      'cancel': 'Annuler',
      'save': 'Enregistrer',
      'edit': 'Modifier',
      'delete': 'Supprimer',
      'view': 'Voir',
      'loading': 'Chargement...',
      'error': 'Erreur',
      'success': 'Succès',
      'warning': 'Avertissement',
      'info': 'Information',
      'dashboard': 'Tableau de bord',
      'certifications': 'Certifications',
      'profile': 'Profil',
      'settings': 'Paramètres',
      'logout': 'Déconnexion',
      'language': 'Langue',
      'theme': 'Thème',
      'dark_mode': 'Mode sombre',
      'light_mode': 'Mode clair',
      'system': 'Système',
      'about': 'À propos',
      'version': 'Version',
      'privacy_policy': 'Politique de confidentialité',
      'terms_of_service': 'Conditions d\'utilisation',
      'contact_support': 'Contacter le support',
      'help': 'Aide',
      'search': 'Rechercher',
      'filter': 'Filtrer',
      'sort': 'Trier',
      'refresh': 'Actualiser',
      'sync': 'Synchroniser',
      'offline': 'Hors ligne',
      'online': 'En ligne',
      'pending': 'En attente',
      'approved': 'Approuvé',
      'rejected': 'Rejeté',
      'draft': 'Brouillon',
      'submitted': 'Soumis',
      'synchronized': 'Synchronisé',
      'waiting_sync': 'En attente de synchronisation',
      'certification_type': 'Type de certification',
      'certification_title': 'Titre',
      'certification_code': 'Code',
      'certification_detail': 'Détail',
      'certification_media': 'Média',
      'certification_location': 'Emplacement',
      'certification_timestamp': 'Horodatage',
      'certification_description': 'Description',
      'certification_attachments': 'Pièces jointes',
      'certification_users': 'Utilisateurs',
      'certification_result': 'Résultat',
      'add_user': 'Ajouter un utilisateur',
      'user_info': 'Informations utilisateur',
      'qr_scan': 'Scan QR',
      'otp_verification': 'Vérification OTP',
      'camera': 'Caméra',
      'gallery': 'Galerie',
      'file_attachment': 'Pièce jointe',
      'live_video': 'Vidéo en direct',
      'geolocation': 'Géolocalisation',
      'activity_type_not_found':
          'Mon type d\'activité n\'est pas inclus dans cette liste ? Contactez JetCV Enterprise à cette adresse : test@mail.com',
      'kyc_verification': 'Vérification KYC',
      'kyc_pending': 'KYC en attente',
      'kyc_completed': 'KYC terminé',
      'kyc_failed': 'KYC échoué',
      'certifier': 'Certificateur',
      'real_time': 'Temps réel',
      'offline_mode': 'Mode hors ligne',
      'trusted_timestamp': 'Horodatage de confiance',
      'system_timestamp': 'Horodatage système',
      'manual_timestamp': 'Horodatage manuel',
      'sync_status': 'Statut de synchronisation',
      'sync_pending': 'En attente de synchronisation',
      'sync_completed': 'Synchronisation terminée',
      'sync_failed': 'Synchronisation échouée',
      'web_frame': 'Cadre Web',
      'verify_call_api': 'Vérifier l\'API d\'appel',
      'check_veriff_session': 'Vérifier la session Veriff',
      'demo_official_mastersheet': 'Démo Feuille de calcul officielle R1.24',
      'certification_types': {
        'type_1': 'Type 1',
        'type_2': 'Type 2',
        'type_3': 'Type 3',
        'type_4': 'Type 4',
        'type_5': 'Type 5',
        'type_6': 'Type 6',
        'type_7': 'Type 7',
        'type_8': 'Type 8',
        'type_9': 'Type 9',
        'type_10': 'Type 10',
        'type_11': 'Type 11',
        'type_12': 'Type 12',
        'type_13': 'Type 13',
        'type_14': 'Type 14',
        'type_15': 'Type 15',
      },
    },
  };

  String getString(String key) {
    final languageCode = locale.languageCode;
    final translations =
        _localizedValues[languageCode] ?? _localizedValues['en']!;

    if (key.contains('.')) {
      final keys = key.split('.');
      dynamic value = translations;
      for (final k in keys) {
        if (value is Map && value.containsKey(k)) {
          value = value[k];
        } else {
          return key; // Fallback to key if translation not found
        }
      }
      return value?.toString() ?? key;
    }

    return translations[key]?.toString() ?? key;
  }

  String getStringWithParams(String key, Map<String, String> params) {
    String text = getString(key);
    params.forEach((param, value) {
      text = text.replaceAll('{$param}', value);
    });
    return text;
  }

  static const List<Locale> supportedLocales = [
    Locale('it', 'IT'),
    Locale('en', 'US'),
    Locale('de', 'DE'),
    Locale('fr', 'FR'),
  ];

  static const List<LocalizationsDelegate<dynamic>> localizationsDelegates = [
    GlobalMaterialLocalizations.delegate,
    GlobalWidgetsLocalizations.delegate,
    GlobalCupertinoLocalizations.delegate,
  ];

  static const List<Locale> supportedLocalesList = [
    Locale('it', 'IT'),
    Locale('en', 'US'),
    Locale('de', 'DE'),
    Locale('fr', 'FR'),
  ];
}

// Delegate per l'internazionalizzazione
class AppLocalizationsDelegate extends LocalizationsDelegate<AppLocalizations> {
  const AppLocalizationsDelegate();

  @override
  bool isSupported(Locale locale) {
    return ['it', 'en', 'de', 'fr'].contains(locale.languageCode);
  }

  @override
  Future<AppLocalizations> load(Locale locale) async {
    await initializeDateFormatting(locale.languageCode);
    return AppLocalizations(locale);
  }

  @override
  bool shouldReload(AppLocalizationsDelegate old) => false;
}
